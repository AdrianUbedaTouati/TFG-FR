[LOG] Escribiendo logs en: outputs/lstm_summary_line_cls\log\train_20250831-155941.log
Modelo seleccionado: LSTM (Clasificación Summary, *una línea -> clase*)
Modo: SIN ventanas deslizantes (seq_len=1).
[TOP-K] Clases seleccionadas (one-hot): ['Partly Cloudy', 'Mostly Cloudy', 'Overcast'] | cobertura=81.16%
[TOP-K] Mantengo 78278/96453 filas (81.16%) pertenecientes al top-3 por frecuencia.
Dataset: data/weatherHistory_normalize.csv
Tiempo: Formatted Date | Clases: 3
Features (18): ['h_sin', 'h_cos', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'Precip Type_normalized', 'Humidity_normalized', 'Wind Speed (km/h)_normalized', 'wind_bearing_sin', 'wind_bearing_cos', 'Visibility (km)_normalized', 'Pressure (millibars)_normalized', 'trend_normalized', 'Temperature (C)_normalized', 'Apparent Temperature (C)_normalized', 'Summary_Mostly Cloudy', 'Summary_Partly Cloudy']
Nota: excluimos 'Summary_*' de FEATURES para evitar fuga de información.
Salida: outputs/lstm_summary_line_cls (guardado class_index.json)
[TOP-K] (one-hot) ['Partly Cloudy', 'Mostly Cloudy', 'Overcast'] | cobertura=81.16%
[TOP-K] Mantengo 78278/96453 filas (81.16%) tras filtrar fuera del top-3.
Inicio entrenamiento — clases=3 | muestras: train=54794, val=11741, test=11743
Epoch 001 | train_loss=0.6484 | train_acc=0.7907 | train_f1=0.7760 | val_loss=0.2226 | val_acc=0.9809 | val_f1=0.9782
Epoch 002 | train_loss=0.0393 | train_acc=0.9988 | train_f1=0.9986 | val_loss=0.0002 | val_acc=1.0000 | val_f1=1.0000
Epoch 003 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 004 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 005 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 006 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 007 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 008 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 009 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 010 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 011 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 012 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 013 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 014 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 015 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 016 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 017 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 018 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 019 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 020 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 021 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 022 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 023 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 024 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 025 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 026 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 027 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 028 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Epoch 029 | train_loss=0.0000 | train_acc=1.0000 | train_f1=1.0000 | val_loss=0.0000 | val_acc=1.0000 | val_f1=1.0000
Traceback (most recent call last):
  File "C:\Users\adrian\Desktop\TFM\TFG-FR\IA_Meteorologica\Réseaux\Data_base_original\LSTM\Clasificacion\summary_2\main_summary_line_cls.py", line 191, in <module>
    main()
  File "C:\Users\adrian\Desktop\TFM\TFG-FR\IA_Meteorologica\Réseaux\Data_base_original\LSTM\Clasificacion\summary_2\main_summary_line_cls.py", line 176, in main
    results = train_lstm_line_cls(cfg)  # ← lo generaré cuando me digas "continua"
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\adrian\Desktop\TFM\TFG-FR\IA_Meteorologica\Réseaux\Data_base_original\LSTM\Clasificacion\summary_2\train_lstm_line_cls.py", line 426, in train_lstm_line_cls
    va_loss, va_acc, va_f1, _, _ = _epoch(model, dl_va, device, crit, optimizer=None, scaler=None, non_blocking=cfg.NON_BLOCKING_COPY)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\adrian\Desktop\TFM\TFG-FR\IA_Meteorologica\Réseaux\Data_base_original\LSTM\Clasificacion\summary_2\train_lstm_line_cls.py", line 317, in _epoch
    total_loss += loss.item() * x.size(0)
                  ^^^^^^^^^^^
KeyboardInterrupt
